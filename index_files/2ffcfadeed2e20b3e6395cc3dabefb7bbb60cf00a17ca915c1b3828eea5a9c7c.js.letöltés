!function(){"use strict";function y(){var e={retryable:!0,withCredentials:!0,url:"".concat(s,"/auth-token-service/v1/login/create")};return n.httpService.post(e).then(function(e){return e}).catch(function(e){return console.debug(e)})}function g(e){var t={retryable:!0,url:"".concat(s,"/auth-token-service/v1/login/status")};return n.httpService.post(t,e).then(function(e){return e}).catch(function(e){return console.debug(e)})}function b(e){var t={retryable:!0,url:"".concat(s,"/auth-token-service/v1/login/cancel")};return n.httpService.post(t,e).then(function(e){return e}).catch(function(e){return console.debug(e)})}function p(){var e={retryable:!0,withCredentials:!0,url:"".concat(s,"/product-experimentation-platform/v1/projects/1/layers/Website.Login.CrossDeviceLogin.DisplayCode/values")},t={parameters:u.join(",")};return n.httpService.get(e,t).then(function(e){return null!=e&&e.data?e.data:Promise.reject()})}function h(){return n.httpService.get({retryable:!0,withCredentials:!0,url:"".concat(s,"/auth-token-service/v1/login/metadata")})}var r={n:function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},d:function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},n=CoreUtilities,E=React,w=r.n(E),t=ReactDOM,e=Roblox,a=r.n(e),i=PropTypes,o=r.n(i),c=ReactUtilities,l="crossDeviceLoginDisplayCodeModal-container",S=CoreRobloxUtilities,x=ReactStyleGuide,s=e.EnvironmentUrls.apiGatewayUrl,u=["alt_title","alt_instruction","alt_device_specific_instruction"];function d(e){var t=e.code,n=e.qrUrl,r=e.translate,a=e.altTitle,i=e.altInstruction,e=e.altDeviceSpecificInstruction,i=i||r("Label.LoginInstructionsV2"),o=e?w().createElement("div",{className:"cross-device-login-device-specific-instruction-text font-caption-header",dangerouslySetInnerHTML:{__html:"".concat(i,"<br>").concat(e)}}):w().createElement("div",{className:"cross-device-login-instruction-text font-caption-header",dangerouslySetInnerHTML:{__html:"".concat(i,"<br>").concat(r("Label.LoginLocationV2"))}});return n?w().createElement("div",null,w().createElement("div",null,w().createElement("b",null,r("Label.QrHeader"))),w().createElement("img",{src:n,alt:"",className:"cross-device-login-display-qr-code-image"}),w().createElement("div",{className:"cross-device-login-instruction-text font-caption-header"},r("Label.QrInstructions"),w().createElement("br",null),w().createElement("a",{href:"https://en.help.roblox.com/hc/en-us/articles/360056582012",target:"_blank",rel:"noreferrer",className:"text-link cross-device-login-instruction-text"},w().createElement("u",null,r("Label.QrTroubleshooting")))),w().createElement("div",{className:"cross-device-login-qr-header-text"},w().createElement("b",null,r("Label.CodeHeader"))),w().createElement("div",{className:"font-title"},t),w().createElement("div",{className:"cross-device-login-instruction-text font-caption-header"},o)):w().createElement("div",null,w().createElement("div",{className:"cross-device-login-display-code-modal-image"}),w().createElement("div",{className:"font-title"},t),w().createElement("div",{className:"cross-device-login-device-prompt-text font-header-2"},a||r("Label.DevicePrompt")),w().createElement("div",{className:"cross-device-login-instruction-text font-caption-header"},o))}d.defaultProps={altTitle:"",altInstruction:"",altDeviceSpecificInstruction:""},d.propTypes={translate:o().func.isRequired,code:o().string.isRequired,qrUrl:o().string.isRequired,altTitle:o().string,altInstruction:o().string,altDeviceSpecificInstruction:o().string};var C=d;function v(e){var t=e.accountName,n=e.accountPictureUrl,e=e.translate;return w().createElement("div",null,w().createElement("div",null,n?w().createElement("img",{className:"cross-device-login-avatar-thumbnail",src:n,alt:"ph-avatar-headshot"}):w().createElement("div",{className:"cross-device-login-display-code-modal-image cross-device-login-ph-avatar-image"}),w().createElement("div",{className:"cross-device-login-device-prompt-text font-header-2"},e("Label.ConfirmOnDevice")),w().createElement("div",{className:"cross-device-login-instruction-text font-caption-header"},e("Label.WebLogginInAs")," ",w().createElement("span",null," ",t," "))))}v.propTypes={translate:o().func.isRequired,accountName:o().func.isRequired,accountPictureUrl:o().func.isRequired};var L=v;function N(e,t,n,r,a,i,o){try{var c=e[i](o),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}function P(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e){var t=e.show,n=e.onHide,r=e.code,a=e.qrUrl,i=e.accountName,o=e.accountPictureUrl,c=e.translate,l=P((0,E.useState)(""),2),s=l[0],u=l[1],d=P((0,E.useState)(""),2),e=d[0],v=d[1],l=P((0,E.useState)(""),2),d=l[0],m=l[1];function f(){var c;return c=regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h();case 2:if(null!=(n=e.sent)&&null!==(t=n.data)&&void 0!==t&&t.ShouldEnableCrossDeviceLoginInitiatorExperiments&&/^en\b/.test(navigator.language))return e.next=6,p();e.next=10;break;case 6:n=e.sent,u(null==n?void 0:n.alt_title),v(null==n?void 0:n.alt_instruction),m(null==n?void 0:n.alt_device_specific_instruction);case 10:case"end":return e.stop()}},e)}),(f=function(){var e=this,o=arguments;return new Promise(function(t,n){var r=c.apply(e,o);function a(e){N(r,t,n,a,i,"next",e)}function i(e){N(r,t,n,a,i,"throw",e)}a(void 0)})}).apply(this,arguments)}return(0,E.useEffect)(function(){return function(){return f.apply(this,arguments)}()},[]),w().createElement(x.Modal,{show:t,onHide:n,className:"cross-device-login-display-code-modal",size:"lg","aria-labelledby":"contained-modal-title-vcenter",scrollable:"true",centered:"true"},w().createElement(x.Modal.Header,{useBaseBootstrapComponent:!0},w().createElement("div",{className:"cross-device-login-display-code-modal-title-container"},w().createElement("button",{type:"button",className:"cross-device-login-display-code-modal-title-button",onClick:n},w().createElement("span",{className:"close icon-close"})),w().createElement(x.Modal.Title,{id:"contained-modal-title-vcenter"},c("Heading.LoginCode")))),w().createElement(x.Modal.Body,null,i?w().createElement(L,{accountName:i,accountPictureUrl:o,translate:c}):w().createElement(C,{code:r,qrUrl:a,translate:c,altTitle:s,altInstruction:e,altDeviceSpecificInstruction:d})))}f.propTypes={translate:o().func.isRequired,onHide:o().func.isRequired,show:o().bool.isRequired,code:o().string.isRequired,qrUrl:o().string.isRequired,accountName:o().string.isRequired,accountPictureUrl:o().string.isRequired};var R=f,q={showModal:{name:"showModal",type:(i=S.eventStreamService.eventTypes).pageLoad,context:"crossDeviceKey"},showProfile:{name:"showProfile",type:i.pageLoad,context:"confirmPrompt"}};function I(e,t,n,r,a,i,o){try{var c=e[i](o),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}function U(c){return function(){var e=this,o=arguments;return new Promise(function(t,n){var r=c.apply(e,o);function a(e){I(r,t,n,a,i,"next",e)}function i(e){I(r,t,n,a,i,"throw",e)}a(void 0)})}}function D(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var M=e.EnvironmentUrls.apiGatewayUrl;function k(e){function t(e){e&&s("".concat(M,"/auth-token-service").concat(e))}var n=e.translate,r=D((0,E.useState)(!1),2),a=r[0],i=r[1],o=D((0,E.useState)(""),2),c=o[0],l=o[1],e=D((0,E.useState)(""),2),r=e[0],s=e[1],o=D((0,E.useState)(""),2),u=o[0],d=o[1],e=D((0,E.useState)(""),2),v=e[0],m=e[1],o=D((0,E.useState)(""),2),e=o[0],f=o[1];window.addEventListener("OpenCrossDeviceLoginDisplayCodeModal",function(e){l(e.detail.code),d(e.detail.privateKey),t(e.detail.imagePath),S.eventStreamService.sendEventWithTarget(q.showModal.type,q.showModal.context,{}),i(!0)},!1);function p(e){return l(""),s(""),d(""),m(""),f(""),i(!1),e?b({code:e}):null}function h(e){l(e.code),d(e.privateKey),t(e.imagePath),m(""),f("")}return(0,E.useEffect)(function(){var i=null;return c&&u&&(i=setInterval(U(regeneratorRuntime.mark(function e(){var t,n,r,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={code:c,privateKey:u},e.prev=1,e.next=4,g(t);case 4:if(r=e.sent,"Cancelled"===(null==(n=r.data)?void 0:n.status))return e.next=9,y();e.next=12;break;case 9:r=e.sent,r=r.data,h(r);case 12:if("UserLinked"===(null==n?void 0:n.status)&&(""===v&&S.eventStreamService.sendEventWithTarget(q.showProfile.type,q.showProfile.context,{}),m(n.accountName||"unknown"),f(n.accountPictureUrl)),"Validated"===(null==n?void 0:n.status))return a=new CustomEvent("OnCrossDeviceCodeValidated",{detail:{ctype:"AuthToken",code:c,privateKey:u}}),window.dispatchEvent(a),p(),e.abrupt("return",clearInterval(i));e.next=19;break;case 19:e.next=28;break;case 21:return e.prev=21,e.t0=e.catch(1),e.next=25,y();case 25:a=e.sent,a=a.data,h(a);case 28:return e.abrupt("return",!1);case 29:case"end":return e.stop()}},e,null,[[1,21]])})),5e3)),function(){return clearInterval(i)}},[v,c,u]),w().createElement(R,{show:a,code:c,qrUrl:r,accountName:v,accountPictureUrl:e,onHide:function(){return p(c)},translate:n})}k.propTypes={translate:o().func.isRequired};var _=k;function A(e){e=e.translate;return w().createElement(_,{translate:e})}A.propTypes={translate:o().func.isRequired};var O=(0,c.withTranslations)(A,{common:[],feature:"Authentication.CrossDevice"});function j(){var e=document.getElementById(l);e?(0,t.render)(w().createElement(O,null),e):window.requestAnimationFrame(j)}a().CrossDeviceLoginDisplayCodeService={openModal:function(){y().then(function(e){e=e.data;"Created"===(null==e?void 0:e.status)&&(e=new CustomEvent("OpenCrossDeviceLoginDisplayCodeModal",{detail:{code:e.code,privateKey:e.privateKey,imagePath:e.imagePath}}),window.dispatchEvent(e))})}},(0,n.ready)(function(){j()})}();
//# sourceMappingURL=https://js.rbxcdn.com/90c8cc16ad79a2a36bd2220d8704190d-crossDeviceLoginDisplayCodeModal.bundle.min.js.map

/* Bundle detector */
window.Roblox && window.Roblox.BundleDetector && window.Roblox.BundleDetector.bundleDetected("CrossDeviceLoginDisplayCode");